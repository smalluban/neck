var Neck;Neck=window.Neck||(window.Neck={}),$('<style media="screen">\n  .ui-hide { display: none !important }\n</style>').appendTo($("head")),Neck.Tools={dashToCamel:function(t){return t.replace(/\W+(.)/g,function(t,e){return e.toUpperCase()})},camelToDash:function(t){return t.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()}},Neck.DI={},Neck.DI.globals={load:function(route,options){var destiny;try{if(destiny=eval(route))return destiny;if("template"!==options.type)throw"Required '"+route+"' object in global scope"}catch(_error){if("template"!==options.type)throw"Required '"+route+"' object in global scope"}return route}},Neck.DI.commonjs={controllerPrefix:"controllers",helperPrefix:"helpers",templatePrefix:"templates",_routePath:/^([a-zA-Z$_][a-zA-Z0-9$_\.]+\/?)+$/i,load:function(t,e){if("template"===e.type&&!t.match(this._routePath))return t;try{return require((e.type?this[e.type+"Prefix"]+"/":"")+t)}catch(r){throw"Required '"+t+"' object path for CommonJS dependency injection"}}};var __bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Controller=function(t){function e(t){var r;switch(null==t&&(t={}),this.remove=__bind(this.remove,this),e.__super__.constructor.apply(this,arguments),r=(this.parent=t.parent)?Object.create(this.parent.scope):{_context:this},this.scope=_.extend(r,this.scope,{_resolves:{}}),this.parent&&(this.listenTo(this.parent,"render:before",this.remove),this.listenTo(this.parent,"remove:before",this.remove),this.injector=this.parent.injector),this.template){case void 0:t.template&&(this.template=t.template);break;case!0:this.template=this.el.innerHTML.trim(),this.el.innerHTML=""}this.params=t.params||{}}return __extends(e,t),e.REVERSE_PARSING="ui-test2"===$("<div ui-test1 ui-test2></div>")[0].attributes[0].name,e.prototype.REGEXPS={PROPERTY_SEPARATOR:/\.|\[.+\]\.?/},e.prototype.divWrapper=!0,e.prototype.parseSelf=!0,e.prototype.template=void 0,e.prototype.injector=Neck.DI.globals,e.prototype.remove=function(){this.trigger("remove:before"),this.parent=void 0,this.scope=void 0,this.template&&this.$el.remove(),this.stopListening(),this.trigger("remove:after")},e.prototype.render=function(){var t,e,r,o,i,n,s,p,l=this;if(this.trigger("render:before"),this._onRender=!0,this.template){for("function"!=typeof this.template?"function"==typeof(e=this.injector.load(this.template,{type:"template"}))&&(e=e(this.scope)):e=this.template(this.scope),this.parseSelf&&this._parseNode(this.el,!0),e=$(e),r=0,i=e.length;r<i;r++)t=e[r],this._parseNode(t);this.divWrapper?this.$el.html(e):this.setElement(e)}else for(s=this.parseSelf?this.$el:this.$el.children(),o=0,n=s.length;o<n;o++)t=s[o],this._parseNode(t);return(null!=(p=this.parent)?p._onRender:void 0)?this.listenToOnce(this.parent,"render:after",function(){return this.trigger("render:after")}):setTimeout(function(){return l.trigger("render:after")}),this._onRender=!1,this},e.prototype._parseNode=function(t,e){var r,o,i,n,s,p,l,c,h,a,u,f,d,y,m,v,w;if(null==e&&(e=!1),null!=t?t.attributes:void 0){for(s=$(t),o=[],m=t.attributes,h=0,f=m.length;h<f;h++)r=m[h],"ui-"===(null!=(v=r.nodeName)?v.substr(0,3):void 0)&&(l=Neck.Tools.dashToCamel(r.nodeName.substr(3)),n=Neck.Helper[l]||this.injector.load(l,{type:"helper"}),n.prototype.orderPriority&&(c=!0),o.push({controller:n,value:r.value}));for(Neck.Controller.REVERSE_PARSING&&o.reverse(),c&&(o=_.sortBy(o,function(t){return-t.controller.prototype.orderPriority})),a=0,d=o.length;a<d;a++)p=o[a],p.controller.prototype.template&&(e=!0),new p.controller({el:s,parent:this,mainAttr:p.value})}if(!e&&t)for(w=t.children,u=0,y=w.length;u<y;u++)i=w[u],this._parseNode(i)},e.prototype._watch=function(t,e,r){var o,i,n,s,p=this;if(null==r&&(r=this),i=t.split(this.REGEXPS.PROPERTY_SEPARATOR)[0],this.scope.hasOwnProperty(i)){if(null!=(s=Object.getOwnPropertyDescriptor(this.scope,i))?s.get:void 0)return r.listenTo(this,"refresh:"+t,e)}else for(o=this;o=o.parent;)if(o.scope.hasOwnProperty(i))return o._watch(t,e,r);return n=this.scope[i],n instanceof Backbone.Model?this.listenTo(n,"change",function(){return p.apply(i)}):n instanceof Backbone.Collection&&this.listenTo(n,"add remove change",function(){return p.apply(i)}),Object.defineProperty(this.scope,i,{enumerable:!0,get:function(){return n},set:function(t){return t instanceof Backbone.Model?(p.stopListening(n),p.listenTo(t,"change",function(){return p.apply(i)})):t instanceof Backbone.Collection&&(p.stopListening(n),p.listenTo(t,"add remove change",function(){return p.apply(i)})),n=t,p.apply(i)}}),r.listenTo(this,"refresh:"+t,e)},e.prototype._getter=function(t,e,r){var o,i;try{i=new Function("scope","__return = "+(e||void 0)+"; return __return;")}catch(n){throw o=n,""+o+" in evaluating accessor '"+(r||e)+"'"}return function(){try{return i(t)}catch(e){if(o=e,o instanceof TypeError)return;throw o}}},e.prototype._setter=function(t,e,r){var o,i;try{i=new Function("scope, __newVal","return "+e+" = __newVal;")}catch(n){throw o=n,""+o+" in evaluating accessor '"+(r||e)+"'"}return function(e){try{return i(t,e)}catch(r){throw o=r}}},e.prototype.watch=function(t,e,r){var o,i,n,s,p=this;for(null==r&&(r=!0),t=t.split(" "),o=function(){return e.apply(p,_.map(t,function(t){return p._getter(p.scope,"scope."+t,t)()}))},n=0,s=t.length;n<s;n++)i=t[n],this._watch(i,o);if(r)return o()},e.prototype.apply=function(t){var e;if(!this.scope.hasOwnProperty(t))for(e=this;e=e.parent;)if(e.scope.hasOwnProperty(t))return e.trigger("refresh:"+t);return this.trigger("refresh:"+t)},e.prototype.route=function(t,e){var r;if(null==e&&(e={"yield":"main"}),!this._yieldList)throw"No yields list. You may call method from controller custructor?";if(!(r=this._yieldList[e["yield"]]))throw"No yield '"+e["yield"]+"' for route in yields chain";return r.append(t,e.params,e.refresh,e.replace)},e.prototype.navigate=function(t,e,r){return null==r&&(r={trigger:!0}),Neck.Router.prototype.navigate(t+(e?"?"+$.param(e):""),r)},e}(Backbone.View);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},__indexOf=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};Neck.Helper=function(t){function e(t){var r,o,i,n,s,p;if(e.__super__.constructor.apply(this,arguments),this._setAccessor("_main",t.mainAttr||""),this.attributes)for(s=this.attributes,i=0,n=s.length;i<n;i++)r=s[i],(o=null!=(p=this.el.attributes[Neck.Tools.camelToDash(r)])?p.value:void 0)&&this._setAccessor(r,o)}return __extends(e,t),e.prototype.REGEXPS=_.extend({},Neck.Controller.prototype.REGEXPS,{PROPERTIES:/\'[^\']*\'|\"[^"]*\"|(\?\ *)*[\.a-zA-Z$_\@][^\ \'\"\{\}\(\):\[\,]*(\ *:)*(\'[^\']*\'|\"[^"]*\")*(\[.*\])*[^\ \'\"\{\}\(\):\,]*/g,ONLY_PROPERTY:/^[a-zA-Z$_][^\ \(\)\{\}\:]*$/g,RESERVED_KEYWORDS:/(^|\ )(true|false|undefined|null|NaN|void|this)($|[\.\ \;])/g,BRACKET_LOOP:/\[(.*)\]/,INLINE_CONDITION:/^\?\ */,CLEAR_CONDITION:/\ +\:$/}),e.prototype.parseSelf=!1,e.prototype.orderPriority=0,e.prototype._propertyChain=function(t){var e,r,o,i,n,s,p;for(e=[],n="",o=!1,i=0,s=0,p=t.length;s<p;s++){if(r=t[s],'"'!==r&&"'"!==r||(o=!o),"["===r)i||o||(i+=1,e.push(n));else if("."===r)o||e.push(n);else if("]"===r)i-=1;else if(" "===r&&!o&&!i)break;n+=r}return e.push(n),e},e.prototype._createObjectChain=function(t,e,r){var o,i,n,s;for(o=e.split("."),n=o.pop();s=o.shift();){if(i=s.split("[")[0],!t[i]){if(s.match(/\[/))throw"Array has to be initialized for helper accessor: '"+r+"'";t[i]={}}if((t=t[i])instanceof Array)return}if(!t.hasOwnProperty(n))return t[n]||(t[n]=void 0)},e.prototype._parseEvaluate=function(t,e,r){var o,i=this;return o=t.replace(this.REGEXPS.PROPERTIES,function(t){var o,n;return"@"!==(o=t.substr(0,1))?'"'!==o&&"'"!==o&&"."!==o&&"?"!==o&&":"!==t[t.length-1]?(t.match(i.REGEXPS.RESERVED_KEYWORDS)||(e.push.apply(e,i._propertyChain(t)),r.push(t),t="scope."+t),t=t.replace(i.REGEXPS.BRACKET_LOOP,function(t){return"["+i._parseEvaluate(t.substr(1,t.length-2),e,r)+"]"})):"?"===o&&(t=t.split(i.REGEXPS.INLINE_CONDITION)[1],'"'===(n=t[0])||"'"===n||t.match(i.REGEXPS.RESERVED_KEYWORDS)||(e.push.apply(e,i._propertyChain(t)),r.push(t.replace(i.REGEXPS.CLEAR_CONDITION,"")),t="scope."+t),t="? "+t):t="scope._context."+t.substr(1),t})},e.prototype._setAccessor=function(t,e){var r,o,i,n,s,p,l,c,h,a,u,f,d,y=this;if(e=e.trim(),h=!1,n=[],a=[],p=this._parseEvaluate(e,n,a),n.length)for(a=_.uniq(a),this.scope._resolves[t]={listeners:[],triggers:[]},d=_.uniq(n),u=0,f=d.length;u<f;u++)for(r=d[u],l=r.split(this.REGEXPS.PROPERTY_SEPARATOR)[0],o=this;o=o.parent;){if(o.scope._resolves[r]){this.scope._resolves[t].listeners=_.union(this.scope._resolves[t].listeners,o.scope._resolves[l].listeners),this.scope._resolves[t].triggers=_.union(this.scope._resolves[t].triggers,o.scope._resolves[l].triggers);break}if(o.scope.hasOwnProperty(l)){this.scope._resolves[t].listeners.push({controller:o,key:r}),__indexOf.call(a,r)>=0&&r!==l&&this.scope._resolves[t].triggers.push({controller:o,key:r}),this._createObjectChain(o.scope,r,e);break}o.parent||(this.scope._resolves[t].listeners.push({controller:this.parent,key:r}),this._createObjectChain(this.parent.scope,r,e))}return i=this._getter(this.parent.scope,p,e),s={enumerable:!0,get:function(){return h?p:i()}},p.match(this.REGEXPS.ONLY_PROPERTY)&&!p.match(this.REGEXPS.RESERVED_KEYWORDS)?(c=this._setter(this.parent.scope,p,e),s.set=function(e){var r;return r=c(e),y.apply(t),r}):s.set=function(e){var r;return h=!0,r=p=e,y.trigger("refresh:"+t),r},Object.defineProperty(this.scope,t,s)},e.prototype._watch=function(t,r,o){var i,n,s,p;null==o&&(o=this);{if(!this.scope._resolves[t])return e.__super__._watch.apply(this,arguments);for(p=this.scope._resolves[t].listeners,n=0,s=p.length;n<s;n++)i=p[n],i.controller._watch(i.key,r,o)}},e.prototype.apply=function(t){var r,o,i,n;{if(!this.scope._resolves[t])return e.__super__.apply.apply(this,arguments);for(n=this.scope._resolves[t].triggers,o=0,i=n.length;o<i;o++)r=n[o],r.controller.trigger("refresh:"+r.key)}},e}(Neck.Controller);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},__slice=[].slice;Neck.Router=function(t){function e(t){if(e.__super__.constructor.apply(this,arguments),!(this.app=null!=t?t.app:void 0))throw"Neck.Router require connection with App Controller"}return __extends(e,t),e.prototype.PARAM_REGEXP=/\:(\w+)/gi,e.prototype._createSettings=function(t){if(t.yields)return t;if("object"==typeof t)return{yields:{main:t}};if("string"==typeof t)return{yields:{main:{controller:t}}};throw"Route structure has to be object or controller name"},e.prototype.route=function(t,r){var o,i=this;return r=this._createSettings(r),o=function(){var e,o,n,s,p,l,c;e=1<=arguments.length?__slice.call(arguments,0):[],_.isObject(n=_.last(e))?e.pop():n={},e.length&&!_.isRegExp(t)&&t.replace(i.PARAM_REGEXP,function(t,r){var o;if(o=e.shift())return n[r]=o}),p=r.yields;for(s in p){if(o=p[s],!(c=null!=(l=i.app._yieldList)?l[s]:void 0))throw"No '"+s+"' yield defined in App";if(o===!1)return c.clear();c.append(o.controller||o,_.extend({},o.params,n),o.refresh,o.replace)}if(r.state)return i.app.scope._state=r.state},e.__super__.route.call(this,t,o)},e}(Backbone.Router);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.App=function(t){function e(){var t=this;e.__super__.constructor.apply(this,arguments),this.routes&&(this.router=new Neck.Router({app:this,routes:this.routes}),this.history&&this.once("render:after",function(){return Backbone.history.start(t.history)}))}return __extends(e,t),e.prototype.routes=!1,e.prototype.history={pushState:!0},e}(Neck.Controller);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.attr=function(t){function e(){if(e.__super__.constructor.apply(this,arguments),"object"!=typeof this.scope._main)throw"'ui-attr' attribute has to be object";this.watch("_main",function(t){var e,r,o;for(e in t)o=t[e],(r=o)?this.$el.attr(e,r===!0?e:r):this.$el.removeAttr(e)})}return __extends(e,t),e}(Neck.Helper);var __bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.bind=function(t){function e(t){this.updateValue=__bind(this.updateValue,this),this.updateView=__bind(this.updateView,this),e.__super__.constructor.apply(this,arguments),void 0===this.scope.bindNumber&&(this.scope.bindNumber=!0),this.$el.is("input, textarea, select")&&(this.isInput=!0,this.$el.is(":checkbox")&&(this.isCheckbox=!0)),this.$el.on("keydown change search",this.updateValue),this.watch("_main",function(t){if(t instanceof Backbone.Model){if(!this.scope.bindProperty)throw"Using Backbone.Model in 'ui-bind' requires 'bind-property'";if("string"!=typeof this.scope.bindProperty)throw"'bind-property' has to be a string";if(this.model===t)return;return this.model&&this.stopListening(this.model),this.model=t,this.listenTo(this.model,"change:"+this.scope.bindProperty,this.updateView),this.updateView()}return this.model&&(this.stopListening(this.model),this.model=void 0),this.updateView()})}return __extends(e,t),e.prototype.attributes=["bindProperty","bindNumber"],e.prototype.NUMBER=/^[0-9]+((\.|\,)?[0-9]+)*$/,e.prototype.isCheckbox=!1,e.prototype.isInput=!1,e.prototype.updateView=function(){var t;return this.isUpdated||(t=this.model?this.model.get(this.scope.bindProperty):this.scope._main,this.isCheckbox?this.$el.prop("checked",!!t):(t=void 0===t?"":t,this.isInput?this.$el.val(t):this.$el.html(t))),this.isUpdated=!1},e.prototype.setValue=function(t){return this.isUpdated=!0,this.model?this.scope._main.set(this.scope.bindProperty,t):this.scope._main=t},e.prototype.calculateValue=function(t){return t.match(this.NUMBER)&&this.scope.bindNumber?Number(t.replace(",",".")):t},e.prototype.updateValue=function(){var t=this;return setTimeout(function(){if(t.scope)return t.isInput?t.isCheckbox?t.setValue(t.$el.is(":checked")?1:0):t.setValue(t.calculateValue(t.$el.val())):t.setValue(t.calculateValue(t.$el.html()))})},e}(Neck.Helper);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper["class"]=function(t){function e(){if(e.__super__.constructor.apply(this,arguments),"object"!=typeof this.scope._main)throw"'ui-class' attribute has to be object";this.watch("_main",function(t){var e,r;for(e in t)r=t[e],this.$el.toggleClass(e,!!r)})}return __extends(e,t),e}(Neck.Helper);var __bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.collection=function(t){function e(){this.resetItems=__bind(this.resetItems,this),this.sortItems=__bind(this.sortItems,this),this.removeItem=__bind(this.removeItem,this),this.addItem=__bind(this.addItem,this);var t,r;e.__super__.constructor.apply(this,arguments),this.itemTemplate=this.template,this.scope.collectionView&&(this.itemTemplate=this.scope.collectionView),this.template=this.scope.collectionEmpty,(t=this.scope.collectionController)&&("string"==typeof t?this.itemController=this.injector.load(t,{type:"controller"}):this.itemController=t),(r=this.scope).collectionItem||(r.collectionItem="item"),this.items=[],this.watch("_main",function(t){if(t&&!(t instanceof Backbone.Collection))throw"'ui-collection' main accessor has to be Backbone.Collection instance";if(t!==this.collection)return this.collection&&this.stopListening(this.collection),(this.collection=t)&&(this.apply("collectionSort"),this.apply("collectionFilter"),this.listenTo(this.collection,"add",this.addItem),this.listenTo(this.collection,"remove",this.removeItem),this.listenTo(this.collection,"sort",this.sortItems),this.listenTo(this.collection,"reset",this.resetItems)),this.resetItems()}),this.watch("collectionSort",function(t){if(t&&this.collection)return this.collection.comparator=t,this.collection.sort()}),this.watch("collectionFilter",function(t){var e,r,o,i,n,s,p;if(t||""===t){if("string"==typeof t){for(s=this.items,r=0,i=s.length;r<i;r++)e=s[r],(e.model+"").toLowerCase().match(t.toLowerCase())?e.$el.removeClass("ui-hide"):e.$el.addClass("ui-hide");return}if("function"==typeof t){for(p=this.items,o=0,n=p.length;o<n;o++)e=p[o],t(e.model)?e.$el.removeClass("ui-hide"):e.$el.addClass("ui-hide");return}}})}return __extends(e,t),e.ItemController=function(t){function e(t){var r=this;e.__super__.constructor.apply(this,arguments),this.model=t.model,Object.defineProperty(this.scope,t.itemName,{enumerable:!0,writable:!0,configurable:!0,value:t.model}),this.scope._index=t.index,t.externalTemplate&&this.listenTo(this.scope[t.itemName],"change",function(){return r.$el.replaceWith(r.render().$el)})}return __extends(e,t),e.prototype.divWrapper=!1,e}(Neck.Controller),e.prototype.attributes=["collectionItem","collectionSort","collectionFilter","collectionView","collectionEmpty","collectionController"],e.prototype.template=!0,e.prototype.itemController=e.ItemController,e.prototype.addItem=function(t){var e;return this.items.length||(this.el.innerHTML=""),this.items.push(e=new this.itemController({template:this.itemTemplate,externalTemplate:this.scope.collectionView,parent:this.parent,model:t,itemName:this.scope.collectionItem,index:this.items.length})),this.$el.append(e.render().$el)},e.prototype.removeItem=function(t){var e,r;if(e=_.findWhere(this.items,{model:t}),this.items.splice(this.items.indexOf(e),1),e.remove(),!(null!=(r=this.collection)?r.length:void 0))return this.renderEmpty()},e.prototype.sortItems=function(){var t,e,r,o;for(o=this.collection.models,e=0,r=o.length;e<r;e++)t=o[e],_.findWhere(this.items,{model:t}).$el.appendTo(this.$el)},e.prototype.resetItems=function(){var t,e,r,o,i,n,s,p;for(n=this.items,e=0,o=n.length;e<o;e++)t=n[e],t.remove();if(this.items=[],this.el.innerHTML="",null==(s=this.collection)||!s.length)return this.renderEmpty();for(p=this.collection.models,r=0,i=p.length;r<i;r++)t=p[r],this.addItem(t)},e.prototype.renderEmpty=function(){if(this.template)return this.render()},e}(Neck.Helper);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.controller=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.watch("_main",function(t){var e;if(t&&"string"!=typeof t)throw"'ui-controller' main accessor has to be string controller ID";if(t!==this.id)return this.controller&&(this.controller.$el=$(),this.controller.remove()),(this.id=t)?(e=this.injector.load(this.id,{type:"controller"}),this.controller=new e({el:this.$el,params:this.scope.controllerParams,template:this.template||this.id,parent:this.scope.controllerInherit?this.parent:void 0}),this.scope.controllerInherit&&(this.controller.scope._context=this.controller),this.controller.injector=this.injector,this.controller.parseSelf=!1,this.controller.render()):void 0})}return __extends(e,t),e.prototype.template=!0,e.prototype.attributes=["controllerParams","controllerInherit"],e.prototype.id=null,e}(Neck.Helper);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.element=function(t){function e(){var t;if(e.__super__.constructor.apply(this,arguments),"string"!=typeof this.scope._main)throw"'ui-element' attribute has to be string";null!=(t=this.parent)&&(t.scope[this.scope._main]=this.$el)}return __extends(e,t),e}(Neck.Helper);var ER,Event,EventHelper,EventList,ev,helper,_i,_len,_ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};for(EventList=["click","dblclick","mouseenter","mouseleave","mouseout","mouseover","mousedown","mouseup","drag","dragstart","dragenter","dragleave","dragover","dragend","drop","load","focus","focusin","focusout","select","blur","submit","scroll","touchstart","touchend","touchmove","touchenter","touchleave","touchcancel","keyup","keydown","keypress"],EventHelper=function(t){function e(t){var r;e.__super__.constructor.apply(this,arguments),"function"==typeof(r=this.scope._main)&&r.call(this.scope._context,t.e),this.scope&&(this.apply("_main"),this.off(),this.stopListening())}return __extends(e,t),e}(Neck.Helper),Event=function(){function t(t){"A"===t.el[0].tagName&&(t.el.attr("href")||t.el.attr("href","#")),t.el.on(this.eventType,function(e){return e.preventDefault(),t.e=e,new EventHelper(t)})}return t}(),_i=0,_len=EventList.length;_i<_len;_i++)ev=EventList[_i],helper=ER=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(Event),helper.prototype.eventType=ev,Neck.Helper[Neck.Tools.dashToCamel("event-"+ev)]=helper;var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.hide=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.watch("_main",function(t){return this.$el.toggleClass("ui-hide",!!t)})}return __extends(e,t),e}(Neck.Helper);var HrefHelper,__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};HrefHelper=function(t){function e(t){e.__super__.constructor.apply(this,arguments),t.e.preventDefault(),Neck.Router.prototype.navigate(this.scope._main,{trigger:!0})}return __extends(e,t),e}(Neck.Helper),Neck.Helper.href=function(){function t(t){t.el.attr("href","#"),t.el.on("click",function(e){return new HrefHelper(_.extend(t,{e:e}))})}return t}();var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.init=function(t){function e(){e.__super__.constructor.apply(this,arguments),"function"==typeof this.scope._main&&this.scope._main.call(this.scope._context)}return __extends(e,t),e}(Neck.Helper);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.list=function(t){function e(){var t;e.__super__.constructor.apply(this,arguments),this.itemTemplate=this.template,this.scope.listView&&(this.itemTemplate=this.scope.listView),this.template=this.scope.listEmpty,(t=this.scope.listController)&&("string"==typeof t?this.itemController=this.injector.load(t,{type:"controller"}):this.itemController=t),this.itemName||(this.itemName="item"),this.items=[],this.watch("_main",function(t){if(t&&!(t instanceof Array))throw"'ui-list' main accessor has to be Array instance";if(this.list!==t)return this.list=t,this.resetItems(),this.scope.listSort&&this.apply("listSort"),this.scope.listFilter?this.apply("listFilter"):void 0}),this.watch("listSort",function(t){var e,r,o,i;if(t&&this.list)for(this.list=_.sortBy(this.list,function(e){return t(e)}),i=this.list,r=0,o=i.length;r<o;r++)e=i[r],_.findWhere(this.items,{item:e}).$el.appendTo(this.$el);else;}),this.watch("listFilter",function(t){var e,r,o,i;if(t||""===t)for(i=this.items,r=0,o=i.length;r<o;r++)e=i[r],(item.model+"").toLowerCase().match(t.toLowerCase())?e.$el.removeClass("ui-hide"):e.$el.addClass("ui-hide");else;})}return __extends(e,t),e.ItemController=function(t){function e(t){e.__super__.constructor.apply(this,arguments),this.item=t.item,Object.defineProperty(this.scope,t.itemName,{enumerable:!0,writable:!0,configurable:!0,value:t.item}),this.scope._index=t.index}return __extends(e,t),e.prototype.divWrapper=!1,e}(Neck.Controller),e.prototype.attributes=["listItem","listSort","listFilter","listView","listEmpty","listController"],e.prototype.template=!0,e.prototype.itemController=e.ItemController,e.prototype.resetItems=function(){var t,e,r,o,i,n,s,p;for(n=this.items,e=0,o=n.length;e<o;e++)t=n[e],t.remove();if(this.items=[],this.el.innerHTML="",null!=(s=this.list)&&s.length)for(p=this.list,r=0,i=p.length;r<i;r++)t=p[r],this.add(t);else if(this.scope.listEmpty&&this.template)return this.render()},e.prototype.add=function(t){return this.items.push(t=new this.itemController({template:this.itemTemplate,parent:this,item:t,itemName:this.itemName,index:this.items.length})),this.$el.append(t.render().$el)},e}(Neck.Helper),$(function(){return $("[ui-neck]").each(function(){var Controller,controller,el,injector,name;return el=$(this),name=eval(el.attr("ui-neck")),injector=Neck.DI[el.attr("neck-injector")?eval(el.attr("neck-injector")):"globals"],Controller=injector.load(name,{type:"controller"}),el.removeAttr("ui-neck"),controller=new Controller({el:el,template:name}),controller.injector=injector,controller.render()})});var RouteHelper,__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};RouteHelper=function(t){function e(t){var r,o;if(e.__super__.constructor.apply(this,arguments),t.e.preventDefault(),r=this.scope.routeYield||"main",!(o=this.scope._context._yieldList[r]))throw"No yield '"+r+"' for route in yields chain";o.append(this.scope._main,this.scope.routeParams,this.scope.routeRefresh,this.scope.routeReplace)}return __extends(e,t),e.prototype.attributes=["routeYield","routeReplace","routeParams","routeRefresh"],e}(Neck.Helper),Neck.Helper.route=function(){function t(t){t.el.on("click",function(e){return new RouteHelper(_.extend(t,{e:e}))})}return t.prototype.template=!1,t}();var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.show=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.$el.addClass("ui-hide"),this.watch("_main",function(t){return this.$el.toggleClass("ui-hide",!t)})}return __extends(e,t),e}(Neck.Helper);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.template=function(t){function e(){var t=this;e.__super__.constructor.apply(this,arguments),this.scope._main=this.template,this.$el.addClass("ui-hide"),setTimeout(function(){return t.remove()})}return __extends(e,t),e.prototype.template=!0,e}(Neck.Helper);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper.value=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.watch("_main",function(t){return this.$el.text(void 0===t?"":t)})}return __extends(e,t),e}(Neck.Helper);var __bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Neck.Helper["yield"]=function(t){function e(){this._popState=__bind(this._popState,this);var t,r=this;if(e.__super__.constructor.apply(this,arguments),this.name=this.scope._main||"main",this.context=this.scope._context,this.list=(t=this.context)._yieldList||(t._yieldList={}),this.list[this.name])throw"There is already yield with '"+this.name+"' name in App";this.list[this.name]=this,this.listenTo(this.context,"render:before remove:after",function(){return delete r.list[r.name]}),this.replace||(this.replace=this.scope.yieldReplace),this.scope.yieldView&&this.append(this.scope.yieldView,this.scope.yieldParams),this.scope.yieldHistory&&(window.addEventListener("popstate",this._popState),this.on("remove:after",function(){return window.removeEventListener("popstate",r._popState)}))}return __extends(e,t),e.prototype.attributes=["yieldView","yieldParams","yieldReplace","yieldInherit","yieldHistory"],e.prototype.template=!0,e.prototype.replace=!1,e.prototype._createController=function(t,e,r){var o,i,n=this;return o=this.injector.load(t,{type:"controller"}),i=new o({template:""+t,params:e,parent:this.scope.yieldInherit?this.context:void 0}),i.injector=this.context.injector,this.scope.yieldInherit&&(i.scope._context=i),i._yieldList=Object.create(this.list),i._yieldPath=t,r._yieldChild=i,r.listenTo(i,"remove:after",function(){return n._backHistory(r),r._yieldChild=void 0}),i.listenTo(r,"remove:after",function(){return i.remove()}),this.$el.append(i.render().$el),i},e.prototype._popState=function(){var t,e,r,o,i;if(this.omitPop)return void(this.omitPop=!1);for(e=history.state,r=this,t=void 0,i=[];r._yieldChild;){if(t=r._yieldChild,t._yieldPath===e){this.omitBack=!0,null!=(o=t._yieldChild)&&o.remove();break}i.push(r=t)}return i},e.prototype._pushHistory=function(t,e){if(this.scope.yieldHistory)return history[e](t,"",void 0)},e.prototype._backHistory=function(t){var e;if(this.scope.yieldHistory){if(this.omitBack)return void(this.omitBack=!1);for(e=0;t._yieldChild;)e+=1,t=t._yieldChild;return this.omitPop=!0,history.back(e)}},e.prototype.append=function(t,e,r,o){var i,n,s,p,l;for(null==r&&(r=!1),null==o&&(o=this.replace),o&&this._yieldChild&&(t===this._yieldChild._yieldPath&&(this._yieldChild._events["render:refresh"]||!r)?null!=(p=this._yieldChild._yieldChild)&&p.remove():(this._yieldChild.remove(),this._yieldChild=void 0)),n=this._yieldChild?"pushState":"replaceState",s=this,i=void 0;s._yieldChild;){if(i=s._yieldChild,i._yieldPath===t){if(r&&!i._events["render:refresh"]){i.remove();break}return i.trigger("render:refresh"),null!=(l=i._yieldChild)&&l.remove(),i._yieldChild=void 0,i}s=s._yieldChild}return this._createController(t,e,s),this._pushHistory(t,n)},e.prototype.clear=function(){if(this._yieldChild)return this._yieldChild.remove(),this._yieldChild=void 0},e}(Neck.Helper);